<!DOCTYPE html>

<html>
    <head>
	    <script src="//www.parsecdn.com/js/parse-1.2.19.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script type="text/javascript" src="/static/campaign.js"></script>
        <script type="text/javascript">
            $(function () {

                var user = Parse.User.current();

                // Must be logged in
                if(user) {
                } else {
                    window.open("/","_self");
                }

                Parse.initialize("zJDkcisSASpMHkV9VCpEJFbkrO16eJv6g1i5UxjU", "NYTIqi6mJbKUr3AbR8JpofmqRfYpWOrz6shdngud");
                var relation = user.relation("campaigns");

                var Campaign = Parse.Object.extend("Campaign");
                var list = '<ul style="list-style-type:none;">';
                relation.query().descending('createdAt').find({
                    success: function(result) {
                        document.getElementById('campaigncount').innerHTML = '' + result.length;
                        for (var i = 0; i < result.length; i++) {
                            var id = result[i].id;
                            list += "<li><a class='clist' href='/viewCampaign?id=" + id + "'</a>" + result[i].get('title') + '</li>';
                        }
                        list += '</ul>';
                        document.getElementById('results').innerHTML = list;
                    }
                });
            });
        </script>
  </head>
  <body>
      <h2> My Campaigns: (<span id="campaigncount"></span>)</h2>
      <a href="/createCampaign">Create a campaign</a>
      <div id="results"></div>
  </body>
</html>
